Запуск скрипта має відбуватися через POST-запит з параметром авторизації у заголовку “token: mytoken”, а сам параметр задається в token.inc.

Налаштування бази даних - db/settings.php

Скрипт призначений для отримання замовлень по апі AsterilCRM API
та їх редагуванню після перевірки по критеріям

Всі параметри(апі, пошук, критерії) задаються в бд у вигляді json

Параметри AsterilCRM API задаються в таблиці api_settings поле settings

Критерії вибірки задаються в таблиці api_params, массив у вигляді json може приймати всі доступні по апі параметри. Рядків в таблиці може бути декілька.

Умови задаються в таблиці api_change_criteria
  
поле criteria {
"order_type": 1,
"additional": {
"custom_field_13": "test2"
}
}, в обов'язковому масиві additional задаються поля замовлення, які будут звірятися, якщо order_type підходить. (їх може бути декілька)

поле changes {
"matched_status": "processed",
"not_matched_status": "confirmed"
} відповідно два обов'язкових поля зі статусами на які будемо міняти статус замовлення в разі виконання або не виконання умов criteria->additional